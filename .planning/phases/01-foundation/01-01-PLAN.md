---
phase: 01-foundation
plan: 01
type: execute
depends_on: []
files_modified:
    - cmd/kamaji/main.go
    - internal/version/version.go
    - go.mod
    - go.sum
---

<objective>
Project scaffolding with Cobra CLI skeleton and version package.

Purpose: Establish the command structure that all Kamaji functionality builds on.
Output: Working `kamaji` binary with `--version` and `--help` flags.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@DESIGN.md

**Reference patterns from stash:**
The stash `tmp` contains proven patterns for:

- `cmd/kamaji/main.go` - Cobra root command setup
- `internal/version/version.go` - Version with ldflags injection

Use `git show stash@{0}:<path>` to view reference implementations.

**Constraints:**

- TDD mandatory - tests before implementation
- Dependencies: cobra, yaml.v3, go-internal/testscript, lipgloss
  </context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Go module with dependencies</name>
  <files>go.mod, go.sum</files>
  <action>
Add required dependencies to go.mod:
- github.com/spf13/cobra (CLI framework)
- gopkg.in/yaml.v3 (YAML parsing)
- github.com/rogpeppe/go-internal/testscript (script testing)
- github.com/charmbracelet/lipgloss (terminal styling)

Run `go mod tidy` to resolve versions.
</action>
<verify>go mod tidy && go mod verify</verify>
<done>go.mod has all 4 dependencies, go.sum populated, verification passes</done>
</task>

<task type="auto">
  <name>Task 2: Create version package</name>
  <files>internal/version/version.go</files>
  <action>
Create version package with ldflags-injectable variables:
- Version (default "dev")
- Commit (default "unknown")
- Date (default "unknown")
- Full() function that returns "Version (Commit, Date)" or just "Version" if Commit is "unknown"

Reference: `git show stash@{0}:internal/version/version.go`
</action>
<verify>go build ./internal/version</verify>
<done>Package compiles, Full() returns "dev" for default values</done>
</task>

<task type="auto">
  <name>Task 3: Create Cobra root command</name>
  <files>cmd/kamaji/main.go</files>
  <action>
Create main.go with Cobra root command:
- Use: "kamaji"
- Short: "Kamaji - orchestrates autonomous coding sprints"
- Version: version.Full()
- SilenceErrors: true (we handle errors ourselves)
- SilenceUsage: true (no auto-usage on error)
- Run: show help
- SetVersionTemplate: "{{.Version}}\n"
- Exit 1 on Execute() error

Reference: `git show stash@{0}:cmd/kamaji/main.go`
</action>
<verify>go build -o bin/kamaji ./cmd/kamaji && ./bin/kamaji --version && ./bin/kamaji --help</verify>
<done>Binary outputs "dev" for --version, shows usage for --help, exits 0</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `go mod verify` passes
- [ ] `go build -o bin/kamaji ./cmd/kamaji` succeeds
- [ ] `./bin/kamaji --version` outputs "dev"
- [ ] `./bin/kamaji --help` shows "orchestrates autonomous coding sprints"
- [ ] `make build` works (uses same build command)
</verification>

<success_criteria>

- All tasks completed
- Binary builds and runs
- Version and help flags work
- No linter errors (`make lint`)
  </success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
