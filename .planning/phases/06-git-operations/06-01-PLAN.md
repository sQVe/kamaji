---
phase: 06-git-operations
plan: 01
type: tdd
depends_on: []
files_modified: [internal/git/git.go, internal/git/git_test.go]
---

<objective>
Implement git branch management for ticket workflows.

Purpose: Enable orchestrator to create feature branches from base branch when starting tickets.
Output: Git package with CreateBranch function and comprehensive tests.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/references/tdd.md
./06-01-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@internal/domain/sprint.go

**From DESIGN.md - Execution flow step 4:**

```
4. If new ticket:
   a. git checkout <base_branch>
   b. git pull origin <base_branch>
   c. git checkout -b <ticket_branch>
```

**Constraints:**

- Use os/exec for git commands (no go-git dependency)
- Functions should accept working directory parameter for testability
- Errors should include git stderr output for debugging
  </context>

<feature>
  <name>CreateBranch - Branch creation from base branch</name>
  <files>internal/git/git.go, internal/git/git_test.go</files>
  <behavior>
    CreateBranch(workDir, baseBranch, ticketBranch string) error

    Cases:
    - Valid inputs: Checks out base, pulls latest, creates ticket branch -> success
    - Base branch doesn't exist: Returns error with git stderr
    - Ticket branch already exists: Returns error with git stderr
    - Not a git repo: Returns error
    - Pull fails (offline): Still creates branch from local base (warning, not error)

    Helper needed:
    - runGit(workDir string, args ...string) (stdout, stderr string, err error)

  </behavior>
  <implementation>
    1. Create internal/git package
    2. runGit helper: exec.Command("git", args...) with dir set, capture stdout/stderr
    3. CreateBranch:
       - runGit(workDir, "checkout", baseBranch)
       - runGit(workDir, "pull", "origin", baseBranch) - log warning if fails, continue
       - runGit(workDir, "checkout", "-b", ticketBranch)
       - Return nil on success, wrap errors with stderr context
  </implementation>
</feature>

<verification>
go test -v ./internal/git/...
</verification>

<success_criteria>

- Failing tests written and committed (RED)
- Implementation passes all tests (GREEN)
- Refactor if needed
- Tests cover: success path, missing base branch, existing ticket branch, non-repo
- Tests use real git commands in temp directories (not mocks)
  </success_criteria>

<output>
After completion, create `.planning/phases/06-git-operations/06-01-SUMMARY.md`:

# Plan 06-01 Summary: Branch Management

**[One-liner: what shipped]**

## TDD Cycles

### CreateBranch

- **RED:** [What tests were written, why they failed]
- **GREEN:** [What implementation made them pass]
- **REFACTOR:** [What cleanup was done, if any]

## Task Commits

- `[hash]` test(06-01): add failing tests for CreateBranch
- `[hash]` feat(06-01): implement CreateBranch

## Files Created/Modified

- `internal/git/git.go` - Git operations package
- `internal/git/git_test.go` - Tests with temp repo fixtures

## Decisions Made

[Key decisions and rationale]
</output>
